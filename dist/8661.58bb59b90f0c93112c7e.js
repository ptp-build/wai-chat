"use strict";(self.webpackChunkwai=self.webpackChunkwai||[]).push([[8661],{70172:(e,t,n)=>{n.d(t,{Z:()=>I});var o=n(60748),r=n(33555),i=n(59187),s=n(83716),a=n(77361),c=n(56112),l=n(2155),d=n(46752),u=n(32340),m=n(6202),p=n(31212),f=n(59107),v=n(3657),h=n(35148);const g=(0,d.y)("Avatar");g.media=g("media"),g.icon=g("icon");const I=(0,o.X$)((({className:e,size:t="large",chat:n,user:I,photo:Z,userStatus:b,text:y,isSavedMessages:P,withVideo:C,noLoop:A,loopIndefinitely:E,lastSyncTime:w,showVideoOverwrite:B,animationLevel:T,noPersonalPhoto:N,observeIntersection:k,onClick:S})=>{const{loadFullUser:x}=(0,r.Sv)(),L=(0,o.sO)(null),R=(0,o.sO)(0),O=(0,v.Op)(L,k),U=I&&(0,c.NB)(I),H=I&&(0,c.pK)(I.id),V=n?.isForum;let M,F;const _=!a.as&&T===s.zy8&&I?.isPremium&&I?.hasVideoAvatar,q=B&&Z?.isVideo,D=O&&C&&(q||_),K=I?.fullInfo?.personalPhoto||I?.fullInfo?.profilePhoto||I?.fullInfo?.fallbackPhoto,G=K?.isVideo,$=D&&(G||q),j="jumbo"===t;P||U||(I&&!N?M=(0,c.RT)(I,j?"big":void 0):n?M=(0,c.RT)(n,j?"big":void 0):Z&&(M=`photo${Z.id}?size=m`,Z.isVideo&&C&&(F=`videoAvatar${Z.id}?size=u`)),G&&(F=(0,c.RT)(I,void 0,"video")));const z=(0,m.Z)(M,!1,i.IU.BlobUrl,w),J=(0,m.Z)(F,!$,i.IU.BlobUrl,w),X=Boolean(z||J),W=Boolean(O&&J&&$),{transitionClassNames:Y}=(0,p.Z)(X,void 0,X,"slow"),Q=(0,o.I4)((e=>{const t=e.currentTarget;J&&(E||(R.current+=1,(R.current>=3||A)&&(t.style.display="none")))}),[E,A,J]),ee=I?.id;(0,o.d4)((()=>{ee&&D&&!K&&x({userId:ee})}),[x,K,ee,D]);const te=(0,f.Z)();let ne;const oe=I?(0,c.Js)(I):n?(0,c.U)(te,n):y;if(P)ne=o.ZP.createElement("i",{className:(0,d.Z)(g.icon,"icon-avatar-saved-messages"),role:"img","aria-label":oe});else if(U)ne=o.ZP.createElement("i",{className:(0,d.Z)(g.icon,"icon-avatar-deleted-account"),role:"img","aria-label":oe});else if(H)ne=o.ZP.createElement("i",{className:(0,d.Z)(g.icon,"icon-reply-filled"),role:"img","aria-label":oe});else if(X)ne=o.ZP.createElement(o.ZP.Fragment,null,o.ZP.createElement("img",{src:z,className:(0,d.Z)(g.media,"avatar-media",Y,J&&"poster"),alt:oe,decoding:"async"}),W&&o.ZP.createElement(h.Z,{canPlay:!0,src:J,className:(0,d.Z)(g.media,"avatar-media","poster"),muted:!0,loop:E,autoPlay:!0,disablePictureInPicture:!0,playsInline:!0,onEnded:Q}));else if(I){const e=(0,c.Js)(I);ne=e?(0,l.Xv)(e,2):void 0}else if(n){const e=(0,c.U)(te,n);ne=e&&(0,l.Xv)(e,(0,c.YC)(n.id)?2:1)}else y&&(ne=(0,l.Xv)(y,2));const re=!P&&I&&b&&(0,c.kM)(I,b),ie=(0,d.Z)(`Avatar size-${t}`,e,`color-bg-${(0,c.Rs)(I||n)}`,P&&"saved-messages",U&&"deleted-account",H&&"replies-bot-account",V&&"forum",re&&"online",S&&"interactive",!P&&!z&&"no-photo"),se=Boolean(P||z),ae=(0,o.I4)((e=>{S&&S(e,se)}),[S,se]),ce=(I||n)&&(I||n).id;return o.ZP.createElement("div",{ref:L,className:ie,onClick:ae,"data-test-sender-id":s.Cgt?ce:void 0,"aria-label":"string"==typeof ne?oe:void 0},"string"==typeof ne?(0,u.Z)(ne,["jumbo"===t?"hq_emoji":"emoji"]):ne)}))},22275:(e,t,n)=>{n.d(t,{Z:()=>d});var o=n(60748),r=n(33555),i=n(11192),s=n(56112),a=n(32340),c=n(59107),l=n(17551);const d=(0,o.X$)((0,r.c$)(((e,{userId:t})=>{const n=(0,i.jr)(e),o=t&&(0,i.dy)(e,t);return{chat:n,contactName:o?(0,s.Vl)(o):void 0}}))((({isOpen:e,chat:t,userId:n,contactName:i,onClose:s})=>{const{deleteChatMember:d}=(0,r.Sv)(),u=(0,c.Z)(),m=(0,o.I4)((()=>{d({chatId:t.id,userId:n}),s()}),[t,d,s,n]);if(t&&n)return o.ZP.createElement(l.Z,{isOpen:e,onClose:s,title:u("GroupRemoved.Remove"),textParts:(0,a.Z)(u("PeerInfo.Confirm.RemovePeer",i)),confirmLabel:u("lng_box_remove"),confirmHandler:m,confirmIsDestructive:!0})})))},17551:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(60748),r=n(59107),i=n(72313),s=n(13103),a=n(231);const c=(0,o.X$)((({isOpen:e,onClose:t,onCloseAnimationEnd:n,title:c,header:l,text:d,textParts:u,confirmLabel:m="Confirm",confirmHandler:p,confirmIsDestructive:f,areButtonsInColumn:v,children:h})=>{const g=(0,r.Z)(),I=(0,o.sO)(null),Z=(0,o.I4)((e=>{-1===e&&p()}),[p]),b=(0,i.Z)(I,e,Z,".Button");return o.ZP.createElement(s.Z,{className:"confirm",title:c||g("Wai"),header:l,isOpen:e,onClose:t,onCloseAnimationEnd:n},d&&d.split("\\n").map((e=>o.ZP.createElement("p",null,e))),u||h,o.ZP.createElement("div",{className:v?"dialog-buttons-column":"dialog-buttons mt-2",ref:I,onKeyDown:b},o.ZP.createElement(a.Z,{className:"confirm-dialog-button",isText:!0,onClick:p,color:f?"danger":"primary"},m),o.ZP.createElement(a.Z,{className:"confirm-dialog-button",isText:!0,onClick:t},g("Cancel"))))}))},21273:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(91713),r=n(60748),i=n(69118),s=n(87675),a=n(77361),c=n(80036);const l=({ref:e,className:t,items:n,itemSelector:l=".ListItem",preloadBackwards:d=20,sensitiveArea:u=800,withAbsolutePositioning:m,maxHeight:p,noScrollRestore:f=!1,noScrollRestoreOnTop:v=!1,noFastList:h,cacheBuster:g,beforeChildren:I,children:Z,onLoadMore:b,onScroll:y,onKeyDown:P,onDragOver:C,onDragLeave:A})=>{let E=(0,r.sO)(null);e&&(E=e);const w=(0,r.sO)({}),[B,T]=(0,r.Ye)((()=>b?[(0,i.Ds)(((e=!1)=>{b({direction:o.Uq.Backwards,noScroll:e})}),1e3,!0,!1),(0,i.Ds)((()=>{b({direction:o.Uq.Forwards})}),1e3,!0,!1)]:[]),[b,n]);(0,r.d4)((()=>{if(!B)return;if(d>0&&(!n||n.length<d))return void B(!0);const{scrollHeight:e,clientHeight:t}=E.current;t&&e<=t&&B()}),[n,B,d]),(0,r.bt)((()=>{const e=E.current,t=w.current;let n;if(t.listItemElements=e.querySelectorAll(l),t.currentAnchor&&Array.from(t.listItemElements).includes(t.currentAnchor)){const{scrollTop:o}=e;n=o+(t.currentAnchor.getBoundingClientRect().top-t.currentAnchorTop)}else{const e=t.listItemElements[0];e&&(t.currentAnchor=e,t.currentAnchorTop=e.getBoundingClientRect().top)}m||f||v&&0===e.scrollTop||((0,s.Z)(e,n),t.isScrollTopJustUpdated=!0)}),[n,l,f,v,g,m]);const N=(0,r.I4)((e=>{if(T&&B){const{isScrollTopJustUpdated:e,currentAnchor:t,currentAnchorTop:n}=w.current,o=w.current.listItemElements;if(e)return void(w.current.isScrollTopJustUpdated=!1);const r=o.length,i=E.current,{scrollTop:s,scrollHeight:a,offsetHeight:c}=i,l=s<=(r?o[0].offsetTop:0)+u,d=(r?o[r-1].offsetTop+o[r-1].offsetHeight:a)-(s+c)<=u;let m=!1;if(l){const e=o[0];if(e){const o=e.getBoundingClientRect().top,r=t?.offsetParent&&t!==e?t.getBoundingClientRect().top:o;t&&void 0!==n&&r>n&&(w.current.currentAnchor=e,w.current.currentAnchorTop=o,m=!0,T())}}if(d){const e=o[r-1];if(e){const o=e.getBoundingClientRect().top,r=t?.offsetParent&&t!==e?t.getBoundingClientRect().top:o;t&&void 0!==n&&r<n&&(w.current.currentAnchor=e,w.current.currentAnchorTop=o,m=!0,B())}}if(!m)if(t?.offsetParent)w.current.currentAnchorTop=t.getBoundingClientRect().top;else{const e=o[0];e&&(w.current.currentAnchor=e,w.current.currentAnchorTop=e.getBoundingClientRect().top)}}y&&y(e)}),[B,T,y,u]);return r.ZP.createElement("div",{ref:E,className:t,onScroll:N,teactFastList:!h&&!m,onKeyDown:P,onDragOver:C,onDragLeave:A},I,m&&n?.length?r.ZP.createElement("div",{teactFastList:!h,style:(0,c.Z)("position: relative",a.wZ&&`height: ${p}px`)},Z):Z)}},13103:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(60748),r=n(517),i=n(46752),s=n(98069),a=n(18674),c=n(31212),l=n(274),d=n(59107),u=n(46590),m=n(231),p=n(62898);const f=({dialogRef:e,title:t,className:n,isOpen:f,isSlim:v,header:h,hasCloseButton:g,noBackdrop:I,noBackdropClose:Z,children:b,style:y,onClose:P,onCloseAnimationEnd:C,onEnter:A,shouldSkipHistoryAnimations:E})=>{const{shouldRender:w,transitionClassNames:B}=(0,c.Z)(f,C,E,void 0,E),T=(0,o.sO)(null);(0,o.d4)((()=>{if(f)return(0,s.l_)(),s.In}),[f]),(0,o.d4)((()=>f?(0,r.Z)({onEsc:P,onEnter:A}):void 0),[f,P,A]),(0,o.d4)((()=>f&&T.current?function(e){function t(t){if("Tab"!==t.key)return;t.preventDefault(),t.stopPropagation();const n=Array.from(e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'));if(!n.length)return;const o=n.findIndex((e=>e.isSameNode(document.activeElement)));let r=0;o>=0&&(r=t.shiftKey?o>0?o-1:n.length-1:o<n.length-1?o+1:0),n[r].focus()}return document.addEventListener("keydown",t,!1),()=>{document.removeEventListener("keydown",t,!1)}}(T.current):void 0),[f]),(0,u.Z)({isActive:f,onBack:P}),(0,l.Z)((([e])=>(document.body.classList.toggle("has-open-dialog",Boolean(f)),(f||!f&&void 0!==e)&&(0,a.YW)(200),()=>{document.body.classList.remove("has-open-dialog")})),[f]);const N=(0,d.Z)();if(!w)return;const k=(0,i.Z)("Modal",n,B,I&&"transparent-backdrop",v&&"slim");return o.ZP.createElement(p.Z,null,o.ZP.createElement("div",{ref:T,className:k,tabIndex:-1,role:"dialog"},o.ZP.createElement("div",{className:"modal-container"},o.ZP.createElement("div",{className:"modal-backdrop",onClick:Z?void 0:P}),o.ZP.createElement("div",{className:"modal-dialog",ref:e},h||(t?o.ZP.createElement("div",{className:"modal-header"},g&&o.ZP.createElement(m.Z,{round:!0,color:"translucent",size:"smaller",ariaLabel:N("Close"),onClick:P},o.ZP.createElement("i",{className:"icon-close"})),o.ZP.createElement("div",{className:"modal-title"},t)):void 0),o.ZP.createElement("div",{className:"modal-content custom-scroll",style:y},b)))))}},42431:(e,t,n)=>{n.d(t,{$5:()=>a,Bj:()=>s,GU:()=>c,Ht:()=>l,fu:()=>u,mU:()=>d});var o=n(14342),r=n(56112),i=n(86087);function s(e,t){const n=(0,o.Z1)(e,t);if(n&&n.fullInfo&&n.fullInfo.groupCallId)return a(e,n.fullInfo.groupCallId)}function a(e,t){return e.groupCalls.byId[t]}function c(e,t,n){return a(e,t)?.participants[n]}function l(e){const t=d(e)?.chatId;if(!t)return!1;const n=(0,o.Z1)(e,t);return!!n&&((0,r.G9)(n)&&n.isCreator||Boolean(n.adminRights?.manageCall))}function d(e){const{groupCalls:{activeGroupCallId:t}}=e;if(t)return a(e,t)}function u(e){const{phoneCall:t,currentUserId:n}=e;if(!t||!t.participantId||!t.adminId)return;const o=t.adminId===n?t.participantId:t.adminId;return(0,i.dy)(e,o)}},9211:(e,t,n)=>{n.d(t,{M:()=>i,P:()=>s});var o=n(86087),r=n(83716);function i(e,t){var n;const{appConfig:i}=e;if(!i)return r.prK[t][0];const s=(0,o.wV)(e),{limits:a}=i,c=null!==(n=a[t][s?1:0])&&void 0!==n?n:r.prK[t][s?1:0];return"dialogFilters"===t?c+1:c}function s(e,t){const{appConfig:n}=e;if(!n)return r.prK[t][1];const{limits:o}=n;return o[t][1]}},27407:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(60748),r=n(91713),i=n(60782),s=n(65326),a=n(87204);function c(e,t,n,o){const{length:i}=e,s=o?e.indexOf(o):0,a=t===r.Uq.Forwards?s:s+1||i,c=Math.max(0,a-n),l=a+n-1,d=e.slice(Math.max(0,c),l+1);let u,m;switch(t){case r.Uq.Forwards:u=a>0,m=c>=0;break;case r.Uq.Backwards:u=a<i,m=l<=i-1}return{newViewportIds:d,areSomeLocal:u,areAllLocal:m}}const l=(e,t,n=!1,l=30)=>{const d=(0,o.sO)(),u=(0,o.sO)((()=>{if(!t||d.current)return;const{newViewportIds:e}=c(t,r.Uq.Forwards,l,t[0]);return e})()),m=(0,s.Z)();n&&(d.current={});const p=(0,a.Z)(t),f=(0,a.Z)(n);if(!t||n||t===p&&n===f)t||(u.current=void 0);else{const{offsetId:e=t[0],direction:n=r.Uq.Forwards}=d.current||{},{newViewportIds:o}=c(t,n,l,e);u.current&&(0,i.et)(u.current,o)||(u.current=o)}const v=(0,o.I4)((({direction:n,noScroll:o})=>{const s=u.current,a=s?n===r.Uq.Backwards?s[s.length-1]:s[0]:void 0;if(!t)return void(e&&e({offsetId:a}));o||(d.current={...d.current,direction:n,offsetId:a});const{newViewportIds:p,areSomeLocal:f,areAllLocal:v}=c(t,n,l,a);!f||s&&(0,i.et)(s,p)||(u.current=p,m()),!v&&e&&e({offsetId:a})}),[t,l,e,m]);return n?[t]:[u.current,v]}},62357:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(60748);const r=function(e,t,n=!1){const r=(0,o.sO)(e);(0,o.bt)((()=>{r.current=e}),[e]),(0,o.d4)((()=>{if(void 0===t)return;const e=setInterval((()=>r.current()),t);return n||r.current(),()=>clearInterval(e)}),[t,n])}},98069:(e,t,n)=>{n.d(t,{In:()=>i,l_:()=>r,wT:()=>s});let o=0;function r(){o+=1}function i(){o-=1}function s(){return o>0}},87675:(e,t,n)=>{n.d(t,{Z:()=>s,z:()=>i});var o=n(77361),r=n(82972);function i(e){e.style.display="none",(0,r.Z)(e),e.style.display=""}const s=(e,t)=>{o.cj&&(e.style.overflow="hidden"),void 0!==t&&(e.scrollTop=t),o.cj&&(e.style.overflow="")}},60054:(e,t,n)=>{n.d(t,{GX:()=>a,H8:()=>m,Jw:()=>u,Sn:()=>f,Tx:()=>d,Wv:()=>s,ep:()=>l,gg:()=>o,hO:()=>r,iu:()=>c,mo:()=>v,vg:()=>p,xh:()=>i,zb:()=>h});const o="1000",r="1010",i="1011",s="1012",a="我是一个AI机器人",c="你现在是一个优秀的助手，请用中文回答我的问题。",l={model:"gpt-3.5-turbo",temperature:1,max_tokens:2e3,presence_penalty:0},d=[{botId:o,command:"start",description:"开始对话"},{botId:o,command:"setting",description:"设置"},{botId:o,command:"aiModel",description:"设置AI模型"},{botId:o,command:"apiKey",description:"设置apiKey"},{botId:o,command:"initPrompt",description:"初始化上下文Prompt"},{botId:o,command:"enableAi",description:"开启或者关闭AI"},{botId:o,command:"clearHistory",description:"清除历史记录"}],u=[{botId:o,command:"start",description:"开始对话"},{botId:o,command:"setting",description:"设置"},{botId:o,command:"lab",description:"实验室"}];let m={users:[{id:"1",accessHash:"",firstName:"",lastName:"",canBeInvitedToGroup:!1,hasVideoAvatar:!1,isMin:!1,isPremium:!1,noStatus:!0,fullInfo:{isBlocked:!1,noVoiceMessages:!1,bio:""},usernames:[{username:"my-self",isActive:!0,isEditable:!0}],type:"userTypeBot",phoneNumber:"",avatarHash:"",isSelf:!0},{id:o,fullInfo:{isBlocked:!1,noVoiceMessages:!1,bio:a,botInfo:{botId:o,description:a,aiType:"ChatGpt",menuButton:{type:"commands"},commands:u}},bot:{chatGptConfig:{config:l,api_key:"",init_system_content:c,max_history_length:4},enableAi:!0},accessHash:"",firstName:"Wai",lastName:"",canBeInvitedToGroup:!1,hasVideoAvatar:!1,isMin:!1,isPremium:!0,noStatus:!0,usernames:[{username:"first_bot",isActive:!0,isEditable:!0}],type:"userTypeBot",phoneNumber:"",avatarHash:"",isSelf:!1}],chats:[{id:o,title:"Wai",type:"chatTypePrivate",isMuted:!1,isMin:!1,hasPrivateLink:!1,isSignaturesShown:!1,isVerified:!0,isJoinToSend:!0,isJoinRequest:!0,isForum:!1,isListed:!0,settings:{isAutoArchived:!1,canReportSpam:!1,canAddContact:!1,canBlockContact:!1},accessHash:""}],chatFolders:[{id:1,title:"机器人",includedChatIds:[o],channels:!1,pinnedChatIds:[],excludedChatIds:[]}],folderIds:[0,1],draftsById:{},replyingToById:{},orderedPinnedIds:[]};const p="...",f="width:4px;",v="你可以通过发送以下命令来控制我：\n\n/setting - 设置面板\n\n/aiModel - 当前模型\n/apiKey - 设置ApiKey\n/initPrompt - 设置初始化上下文Prompt, 每次请求都会带入\n/enableAi - 开启或者关闭AI\n",h="你可以通过发送以下命令来控制我：\n\n/setting - 设置面板\n\n/lab - 实验室\n\n  * 创建 ChatGpt机器人\n  * 创建 中文Prompt大全\n  * 创建 英文Prompt大全\n\n"}}]);
//# sourceMappingURL=8661.58bb59b90f0c93112c7e.js.map