(self.webpackChunkwai=self.webpackChunkwai||[]).push([[8743],{89618:(t,e,r)=>{var n=r(48764).Buffer;const i=r(24736),o=r(66842);function s(t,e=!0,r=!1){let o=n.from(t);const s=o.length;e&&(o=o.reverse());let c=i(o.toString("hex"),16);return r&&Math.floor(c.toString("2").length/8)>=s&&(c=c.subtract(i(2).pow(i(8*s)))),c}function c(t,e=8){const r=i(t),o=[];for(let t=0;t<e;t++)o[t]=r.shiftRight(8*t).and(255);return n.from(o)}function u(t,e,r=!0,o=!1){const s=(t=i(t)).bitLength();if(e<Math.ceil(s/8))throw new Error("OverflowError: int too big to convert");if(!o&&t.lesser(i(0)))throw new Error("Cannot convert to unsigned");let c=!1;t.lesser(i(0))&&(c=!0,t=t.abs());const u=t.toString("16").padStart(2*e,"0");let a=n.from(u,"hex");if(r&&(a=a.reverse()),o&&c)if(r){let t=!1;0!==a[0]&&(a[0]-=1);for(let e=0;e<a.length;e++)0!==a[e]?(t&&(a[e]-=1,t=!1),a[e]=255-a[e]):t=!0}else{a[a.length-1]=256-a[a.length-1];for(let t=0;t<a.length-1;t++)a[t]=255-a[t]}return a}function a(t){return n.from(o.randomBytes(t))}function f(t){const e=o.createHash("sha1");return e.update(t),e.digest()}let l;t.exports={readBigIntFromBuffer:s,readBufferFromBigInt:u,generateRandomLong:function(t=!0){return s(a(8),!0,t)},mod:function(t,e){return(t%e+e)%e},crc32:function(t){l||(l=function(){let t;const e=[];for(let r=0;r<256;r++){t=r;for(let e=0;e<8;e++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}()),n.isBuffer(t)||(t=n.from(t));let e=-1;for(let r=0;r<t.length;r++){const n=t[r];e=l[255&(e^n)]^e>>>8}return(-1^e)>>>0},generateRandomBytes:a,generateKeyDataFromNonce:async function(t,e){t=c(t,16),e=c(e,32);const[r,i,o]=await Promise.all([f(n.concat([e,t])),f(n.concat([t,e])),f(n.concat([e,e]))]);return{key:n.concat([r,i.slice(0,12)]),iv:n.concat([i.slice(12,20),o,e.slice(0,4)])}},sha1:f,sha256:function(t){const e=o.createHash("sha256");return e.update(t),e.digest()},bigIntMod:function(t,e){return t.remainder(e).add(e).remainder(e)},modExp:function(t,e,r){t=t.remainder(r);let n=i.one,o=t;for(;e.greater(i.zero);){const t=e.remainder(i(2));e=e.divide(i(2)),t.eq(i.one)&&(n=n.multiply(o),n=n.remainder(r)),o=o.multiply(o),o=o.remainder(r)}return n},getRandomInt:function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t},sleep:t=>new Promise((e=>{setTimeout(e,t)})),getByteArray:function(t,e=!1){const r=t.toString(2).length,n=Math.floor((r+8-1)/8);return u(i(t),n,!1,e)},toSignedLittleBuffer:c,convertToLittle:function(t){const e=n.alloc(4*t.length);for(let r=0;r<t.length;r++)e.writeUInt32BE(t[r],4*r);return e},bufferXor:function(t,e){const r=[];for(let n=0;n<t.length;n++)r.push(t[n]^e[n]);return n.from(r)}}},74121:(t,e,r)=>{"use strict";function n(t){const e=new Uint8Array(4*t.length);let r=0;for(let n=0;n<t.length;n++){const i=t[n];e[r++]=i>>>24,e[r++]=i>>16&255,e[r++]=i>>8&255,e[r++]=255&i}return e.buffer}function i(t){return t.buffer}function o(t){const e=new Uint8Array(t),r=new Uint32Array(e.length/4);for(let t=0;t<e.length;t+=4)r[t/4]=e[t]<<24^e[t+1]<<16^e[t+2]<<8^e[t+3];return r}function s(t){return new Uint32Array(t)}r.r(e),r.d(e,{ab2i:()=>a,ab2iBig:()=>s,ab2iLow:()=>o,i2ab:()=>u,i2abBig:()=>i,i2abLow:()=>n,isBigEndian:()=>c});const c=1===new Uint8Array(new Uint32Array([16909060]))[0],u=c?i:n,a=c?s:o},66842:(t,e,r)=>{var n=r(48764).Buffer;const i=r(28136).default,{i2ab:o,ab2i:s}=r(74121),{getWords:c}=r(77760);class u{constructor(t){this.setBytes(t)}setBytes(t){t=n.from(t),this._counter=t}increment(){for(let t=15;t>=0;t--){if(255!==this._counter[t]){this._counter[t]++;break}this._counter[t]=0}}}class a{constructor(t,e){e instanceof u||(e=new u(e)),this._counter=e,this._remainingCounter=void 0,this._remainingCounterIndex=16,this._aes=new i(c(t))}update(t){return this.encrypt(t)}encrypt(t){const e=n.from(t);for(let t=0;t<e.length;t++)16===this._remainingCounterIndex&&(this._remainingCounter=n.from(o(this._aes.encrypt(s(this._counter._counter)))),this._remainingCounterIndex=0,this._counter.increment()),e[t]^=this._remainingCounter[this._remainingCounterIndex++];return e}}class f{constructor(t){this.algorithm=t}update(t){this.data=new Uint8Array(t)}async digest(){return"sha1"===this.algorithm?n.from(await self.crypto.subtle.digest("SHA-1",this.data)):"sha256"===this.algorithm?n.from(await self.crypto.subtle.digest("SHA-256",this.data)):void 0}}t.exports={createCipheriv:function(t,e,r){if(t.includes("ECB"))throw new Error("Not supported");return new a(e,r)},createDecipheriv:function(t,e,r){if(t.includes("ECB"))throw new Error("Not supported");return new a(e,r)},randomBytes:function(t){const e=new Uint8Array(t);return crypto.getRandomValues(e),e},createHash:function(t){return new f(t)},pbkdf2:async function(t,e,r){const i=await crypto.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits"]);return n.from(await crypto.subtle.deriveBits({name:"PBKDF2",hash:"SHA-512",salt:e,iterations:r},i,512))}}},77760:(t,e,r)=>{"use strict";function n(t,e){return t.charCodeAt(e)<<24^t.charCodeAt(e+1)<<16^t.charCodeAt(e+2)<<8^t.charCodeAt(e+3)}function i(t){if(t instanceof Uint32Array)return t;if("string"==typeof t){if(t.length%4!=0)for(let e=t.length%4;e<=4;e++)t+="\0x00";const e=new Uint32Array(t.length/4);for(let r=0;r<t.length;r+=4)e[r/4]=n(t,r);return e}if(t instanceof Uint8Array){const e=new Uint32Array(t.length/4);for(let r=0;r<t.length;r+=4)e[r/4]=t[r]<<24^t[r+1]<<16^t[r+2]<<8^t[r+3];return e}throw new Error("Unable to create 32-bit words")}function o(t,e,r=t){for(let n=0;n<t.length;n++)r[n]=t[n]^e[n]}r.r(e),r.d(e,{getWords:()=>i,s2i:()=>n,xor:()=>o})},975:(t,e,r)=>{"use strict";r(82752)},79441:(t,e,r)=>{"use strict";r(82752)},37729:(t,e,r)=>{"use strict";r(82752)},56106:(t,e,r)=>{"use strict";r(82752)},16494:(t,e,r)=>{"use strict";r(82752)},83551:(t,e,r)=>{"use strict";r(82752)},35585:(t,e,r)=>{"use strict";r(82752)},46008:(t,e,r)=>{"use strict";r(82752)},68991:(t,e,r)=>{"use strict";r(82752)},60014:(t,e,r)=>{"use strict";r(82752)},82621:(t,e,r)=>{"use strict";r(82752)},54373:(t,e,r)=>{"use strict";r(82752)},8315:(t,e,r)=>{"use strict";r(82752)},28475:(t,e,r)=>{"use strict";r(82752)},88605:(t,e,r)=>{"use strict";r(82752)},37717:(t,e,r)=>{"use strict";r(82752)},9541:(t,e,r)=>{"use strict";r(82752)},12901:(t,e,r)=>{"use strict";r(82752)},99061:(t,e,r)=>{"use strict";r(82752)},30888:(t,e,r)=>{"use strict";r(82752)},4199:(t,e,r)=>{"use strict";r(82752)},84212:(t,e,r)=>{"use strict";r(82752)},91965:(t,e,r)=>{"use strict";r(82752)},83630:(t,e,r)=>{"use strict";r(82752)},42183:(t,e,r)=>{"use strict";r(82752)},94595:(t,e,r)=>{"use strict";r(82752)},5328:(t,e,r)=>{"use strict";r(82752)},97631:(t,e,r)=>{"use strict";r(82752)}}]);
//# sourceMappingURL=8743.b1faa8f2674d3eb45349.js.map